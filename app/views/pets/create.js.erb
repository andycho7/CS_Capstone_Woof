$('#new_pet_card_<%= @pet.group.id.to_s %>').before('<%= j render(:partial => 'pets/card', :locals => {group: @pet.group, pet: @pet, j: 0, weight_options: Weight.all}) %>');
// clear new form fields
var card = $('#new_pet_card_group_<%=@pet.group_id.to_s%>');
card.replaceWith('<%= j render(:partial => 'pets/form_card', :locals => {group: @pet.group, pet: Pet.new, weight_options: Weight.all, hide: false}) %>');

$('.breed-selector').select2({
  placeholder: 'Select breed',
  allowClear: true,
  theme: 'bootstrap',
  ajax: {
    url: '/breeds/find',
    data: function(params) {
      return {
        name: params.term
      };
    },
    dataType: 'json',
    delay: 500,
    processResults: function(data, params) {
      return {
        results: _.map(data, function(el) {
          return {
            id: el.id,
            name: el.name
          };
        })
      };
    },
    cache: true
  },
  escapeMarkup: function(markup) {
    return markup;
  },
  minimumInputLength: 2,
  templateResult: function(item) {
    return item.name;
  },
  templateSelection: function(item) {
    return item.name || item.text;
  }
});

$('.colors-selector').select2({
  placeholder: 'Select Colors',
  allowClear: true,
  theme: 'bootstrap',
  ajax: {
    url: '/colors/find',
    data: function(params) {
      return {
        name: params.term
      };
    },
    dataType: 'json',
    delay: 500,
    processResults: function(data, params) {
      return {
        results: _.map(data, function(el) {
          return {
            id: el.id,
            name: el.name
          };
        })
      };
    },
    cache: true
  },
  escapeMarkup: function(markup) {
    return markup;
  },
  minimumInputLength: 2,
  templateResult: function(item) {
    return item.name;
  },
  templateSelection: function(item) {
    return item.name || item.text;
  }
});

$('.weight-selector').select2({
  placeholder: 'Select weight range',
  allowClear: true,
  theme: 'bootstrap'
});
